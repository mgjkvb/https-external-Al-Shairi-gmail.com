<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙƒØ´Ù Ø§Ù„Ø¹Ù…Ù„ - ÙØ±Ø²Ø§ØªØ´ÙŠ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠØ©</title>
<style>
* { box-sizing: border-box; }
body { 
    font-family: "Cairo", sans-serif; 
    background: #fdfbf8; 
    color: #333; 
    margin:0; 
    padding:0; 
    text-align:center; 
}
header { 
    background: black; 
    color: gold; 
    padding:12px; 
    font-size:1.2em; 
    font-weight:bold;
    position: sticky;
    top: 0;
    z-index: 100;
}
.container { 
    padding:15px; 
    max-width:1000px; 
    margin:auto; 
}
.input-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 15px;
}
.input-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
}
.input-row input, 
.input-row select, 
.input-row textarea {
    flex: 1;
    min-width: 120px;
}
.table-container {
    overflow-x: auto;
    margin-top: 15px;
}
table { 
    width:100%; 
    border-collapse:collapse; 
    font-size: 0.9em;
    min-width: 600px;
}
th, td { 
    border:1px solid #ccc; 
    padding:8px 4px; 
    word-break: break-word;
}
th { 
    background:black; 
    color:gold; 
    font-size: 0.85em;
}
button { 
    background:black; 
    color:gold; 
    border:none; 
    padding:8px 12px; 
    border-radius:6px; 
    cursor:pointer; 
    margin:3px;
    font-size: 0.85em;
    white-space: nowrap;
}
button:hover { 
    background:gold; 
    color:black; 
}
.delete-all {
    background: #d32f2f;
    color: white;
}
.delete-all:hover {
    background: #b71c1c;
}
input, select, textarea { 
    padding:10px; 
    border:1px solid #ccc; 
    border-radius:6px; 
    font-size: 1em;
    width: 100%;
}
textarea {
    min-height: 60px;
    resize: vertical;
}
#summary { 
    margin-top:15px; 
    font-size:1.1em; 
    font-weight:bold; 
    text-align:center;
    padding: 10px;
    background: #f5f5f5;
    border-radius: 6px;
}
.buttons-group {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 5px;
    margin: 10px 0;
}
.filter-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin: 15px 0;
    padding: 10px;
    background: #f0f0f0;
    border-radius: 8px;
}
.filter-item {
    flex: 1;
    min-width: 140px;
}
.invoice-input {
    background: #fffacd;
    font-weight: bold;
}
.invoice-warning {
    color: #d32f2f;
    font-weight: bold;
    font-size: 0.9em;
    margin-top: 5px;
}
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    th, td {
        padding: 6px 3px;
        font-size: 0.8em;
    }
    button {
        padding: 6px 8px;
        font-size: 0.8em;
        margin: 2px;
    }
    .input-row {
        flex-direction: column;
    }
    .input-row input, 
    .input-row select {
        min-width: 100%;
    }
    table {
        font-size: 0.8em;
        min-width: 500px;
    }
    .buttons-group {
        gap: 3px;
    }
    .filter-group {
        flex-direction: column;
    }
}
@media (max-width: 480px) {
    header {
        font-size: 1.1em;
        padding: 10px;
    }
    th, td {
        padding: 4px 2px;
        font-size: 0.75em;
    }
    button {
        padding: 5px 6px;
        font-size: 0.75em;
    }
    #summary {
        font-size: 1em;
    }
}
@media print { 
    .no-print { display:none; } 
    header { color:black; background:none; }
    .container { padding: 0; }
}
</style>
</head>
<body>
<header>ÙØ±Ø²Ø§ØªØ´ÙŠ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠØ© - ÙƒØ´Ù Ø§Ù„Ø¹Ù…Ù„</header>

<div class="container">
<div class="no-print">
    <div class="input-group">
        <div class="input-row">
            <input type="number" id="invoiceNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©" class="invoice-input" min="2301" max="3000">
            <input type="date" id="date">
            <select id="size">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                <option>24</option>
                <option>26</option><option>28</option><option>30</option><option>32</option><option>34</option>
                <option>36</option><option>38</option><option>40</option><option>42</option><option>44</option>
                <option>46</option><option>48</option><option>50</option>
            </select>
            <input type="number" id="count" placeholder="Ø§Ù„Ø¹Ø¯Ø¯">
        </div>
        <textarea id="note" placeholder="Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª"></textarea>
        <div id="invoiceWarning" class="invoice-warning"></div>
    </div>
    
    <div class="buttons-group">
        <button onclick="addRow()">â• Ø¥Ø¶Ø§ÙØ©</button>
        <button onclick="saveData()">ğŸ’¾ Ø­ÙØ¸</button>
        <button onclick="printFiltered()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ù„Ø®Øµ</button>
        <button onclick="printFullTable()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© ÙƒØ§Ù…Ù„</button>
        <button onclick="generatePDF()">ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡ PDF</button>
        <button onclick="sendWhatsAppPDFText()">ğŸ’¬ Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨</button>
        <button onclick="deleteAll()" class="delete-all">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
    </div>

    <div class="filter-group">
        <div class="filter-item">
            <label>ÙÙ„ØªØ± Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…: </label>
            <input type="date" id="filterDate" onchange="applyFilters()">
        </div>
        <div class="filter-item">
            <label>ÙÙ„ØªØ± Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹: </label>
            <select id="filterType" onchange="applyFilters()">
                <option value="">Ø§Ù„ÙƒÙ„</option>
                <option>24</option>
                <option>26</option><option>28</option><option>30</option><option>32</option><option>34</option>
                <option>36</option><option>38</option><option>40</option><option>42</option><option>44</option>
                <option>46</option><option>48</option><option>50</option>
            </select>
        </div>
        <div class="filter-item">
            <label>ÙÙ„ØªØ± Ø­Ø³Ø¨ Ø§Ù„ÙØ§ØªÙˆØ±Ø©: </label>
            <input type="number" id="filterInvoice" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©" onchange="applyFilters()">
        </div>
    </div>
</div>

<div class="table-container">
    <table id="workTable">
    <thead>
    <tr>
    <th>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
    <th>Ø§Ù„Ù†ÙˆØ¹</th>
    <th>Ø§Ù„Ø¹Ø¯Ø¯</th>
    <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
    <th class="no-print">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
    </tr>
    </thead>
    <tbody></tbody>
    </table>
</div>

<div id="summary">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø¯: 0</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
let table = document.querySelector("#workTable tbody");
let lastInvoice = Number(localStorage.getItem("lastInvoice") || 2300); // ÙŠØ¨Ø¯Ø£ Ù…Ù† 2300 Ù„ÙŠØµØ¨Ø­ Ø§Ù„Ø£ÙˆÙ„ 2301

// Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ø¨ØµÙŠØºØ© YYYY-MM-DD
function getTodayDate() {
    const today = new Date();
    const year = today.getFullYear();
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const day = String(today.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}

// Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©
function validateInvoiceNumber(invoiceNum) {
    const warningElement = document.getElementById('invoiceWarning');
    
    if (invoiceNum < 2301 || invoiceNum > 3000) {
        warningElement.textContent = 'Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 2301 Ùˆ 3000';
        return false;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    let existingInvoices = [];
    table.querySelectorAll("tr").forEach(r => {
        existingInvoices.push(parseInt(r.children[0].textContent));
    });
    
    if (existingInvoices.includes(invoiceNum)) {
        warningElement.textContent = 'Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹!';
        return false;
    }
    
    warningElement.textContent = '';
    return true;
}

// ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
window.onload = function() {
    document.getElementById('date').value = getTodayDate();
    // ØªØ¹ÙŠÙŠÙ† Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    document.getElementById('invoiceNumber').value = lastInvoice + 1;
    
    // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    document.getElementById('invoiceNumber').addEventListener('input', function() {
        const invoiceNum = parseInt(this.value);
        if (!isNaN(invoiceNum)) {
            validateInvoiceNumber(invoiceNum);
        } else {
            document.getElementById('invoiceWarning').textContent = '';
        }
    });
};

function addRow() {
  let invoiceInput = document.getElementById("invoiceNumber").value;
  let date = document.getElementById("date").value;
  let size = document.getElementById("size").value;
  let count = document.getElementById("count").value;
  let note = document.getElementById("note").value;
  
  if (!invoiceInput || !date || !size || !count) { 
      alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©."); 
      return; 
  }

  let invoiceNum = parseInt(invoiceInput);
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©
  if (!validateInvoiceNumber(invoiceNum)) {
      return;
  }

  // ØªØ­Ø¯ÙŠØ« lastInvoice Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ø®Ù„ Ø£ÙƒØ¨Ø± ÙˆÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø³Ù…ÙˆØ­
  if (invoiceNum > lastInvoice && invoiceNum <= 3000) {
      lastInvoice = invoiceNum;
      localStorage.setItem("lastInvoice", lastInvoice);
  }

  let row = document.createElement("tr");
  row.innerHTML = `<td>${invoiceNum}</td><td>${date}</td><td>${size}</td><td>${count}</td><td>${note}</td>
  <td class="no-print">
    <button onclick="editRow(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
    <button onclick="deleteRow(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
  </td>`;
  table.appendChild(row);
  clearFields(); 
  saveData(); 
  updateSummary();
}

function clearFields() {
  // Ù„Ø§ Ù†Ù…Ø³Ø­ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…ØŒ Ø¨Ù„ Ù†Ø¹ÙŠØ¯ ØªØ¹ÙŠÙŠÙ†Ù‡ Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
  document.getElementById("date").value = getTodayDate();
  // ØªØ¹ÙŠÙŠÙ† Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£Ù‚Ù„ Ù…Ù† 3000)
  let nextInvoice = lastInvoice + 1;
  if (nextInvoice <= 3000) {
      document.getElementById("invoiceNumber").value = nextInvoice;
  } else {
      document.getElementById("invoiceNumber").value = '';
      document.getElementById("invoiceWarning").textContent = 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¢Ø®Ø± Ø±Ù‚Ù… ÙØ§ØªÙˆØ±Ø© (3000)';
  }
  document.getElementById("size").value=""; 
  document.getElementById("count").value=""; 
  document.getElementById("note").value="";
  document.getElementById("invoiceWarning").textContent = '';
}

function editRow(btn) {
  let password = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ØªØ¹Ø¯ÙŠÙ„:"); 
  if(password!=="1234"){alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!"); return;}
  let row=btn.parentElement.parentElement;
  document.getElementById("invoiceNumber").value = row.children[0].textContent;
  document.getElementById("date").value=row.children[1].textContent;
  document.getElementById("size").value=row.children[2].textContent;
  document.getElementById("count").value=row.children[3].textContent;
  document.getElementById("note").value=row.children[4].textContent;
  row.remove(); 
  saveData(); 
  updateSummary();
}

function deleteRow(btn) {
  let password = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø­Ø°Ù:"); 
  if(password!=="1234"){alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!"); return;}
  btn.parentElement.parentElement.remove(); 
  saveData(); 
  updateSummary();
}

function deleteAll() {
  let password = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:"); 
  if(password!=="1234"){alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!"); return;}
  
  if(confirm("âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!")) {
    table.innerHTML = "";
    lastInvoice = 2300; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¥Ù„Ù‰ 2300
    localStorage.setItem("lastInvoice", lastInvoice);
    saveData();
    updateSummary();
    clearFields();
    alert("ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­.");
  }
}

function saveData() {
  let rows=[]; 
  table.querySelectorAll("tr").forEach(r=>{
    rows.push({
      invoice:r.children[0].textContent,
      date:r.children[1].textContent,
      size:r.children[2].textContent,
      count:r.children[3].textContent,
      note:r.children[4].textContent
    });
  });
  localStorage.setItem("workData", JSON.stringify(rows));
}

function loadData() {
  let data = JSON.parse(localStorage.getItem("workData") || "[]");
  data.forEach(d=>{
    let row=document.createElement("tr");
    row.innerHTML=`<td>${d.invoice}</td><td>${d.date}</td><td>${d.size}</td><td>${d.count}</td><td>${d.note}</td>
    <td class="no-print">
      <button onclick="editRow(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
      <button onclick="deleteRow(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
    </td>`;
    table.appendChild(row);
  });
  if(data.length>0){
    let invoices = data.map(d=>Number(d.invoice));
    lastInvoice = Math.max(...invoices); 
    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† lastInvoice Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ² 3000
    if (lastInvoice > 3000) lastInvoice = 3000;
    localStorage.setItem("lastInvoice", lastInvoice);
  }
  updateSummary();
}
loadData();

function updateSummary(){
  let total=0;
  table.querySelectorAll("tr").forEach(r=>total+=Number(r.children[3].textContent||0));
  document.getElementById("summary").textContent=`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø¯: ${total}`;
}

function applyFilters(){
  let filterDate=document.getElementById("filterDate").value;
  let filterType=document.getElementById("filterType").value;
  let filterInvoice=document.getElementById("filterInvoice").value;
  
  table.querySelectorAll("tr").forEach(r=>{
    let show=true;
    if(filterDate && r.children[1].textContent!==filterDate) show=false;
    if(filterType && r.children[2].textContent!==filterType) show=false;
    if(filterInvoice && r.children[0].textContent!==filterInvoice) show=false;
    r.style.display=show?"":"none";
  });
  updateSummary();
}

function printFiltered(){ 
  applyFilters(); 
  window.print(); 
}

function printFullTable(){
  table.querySelectorAll("tr").forEach(r=>r.style.display="");
  updateSummary();
  window.print();
}

function generatePDF() {
  applyFilters();
  let container = document.createElement('div');
  container.style.padding = '20px';
  
  let header = document.createElement('h2');
  header.textContent = "ÙØ±Ø²Ø§ØªØ´ÙŠ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠØ© - ÙØ§ØªÙˆØ±Ø© Ø¹Ù…Ù„";
  header.style.textAlign = "center";
  header.style.marginBottom = "20px";
  container.appendChild(header);
  
  let tableClone = document.getElementById("workTable").cloneNode(true);
  tableClone.querySelectorAll(".no-print").forEach(el => el.remove());
  container.appendChild(tableClone);
  
  let totalDiv = document.createElement('div');
  totalDiv.textContent = document.getElementById("summary").textContent;
  totalDiv.style.textAlign = "center"; 
  totalDiv.style.fontWeight = "bold"; 
  totalDiv.style.marginTop = "15px";
  totalDiv.style.fontSize = "1.2em";
  container.appendChild(totalDiv);
  
  html2pdf().from(container).save("ÙØ§ØªÙˆØ±Ø©_ÙØ±Ø²Ø§ØªØ´ÙŠ.pdf");
}

function sendWhatsAppPDFText() {
  generatePDF();
  applyFilters();
  
  let rows=[];
  let totalCount=0;
  table.querySelectorAll("tr").forEach(r=>{
    if(r.style.display!=="none"){
      rows.push(`|${r.children[0].textContent}|${r.children[1].textContent}|${r.children[2].textContent}|${r.children[3].textContent}|${r.children[4].textContent}|`);
      totalCount+=Number(r.children[3].textContent||0);
    }
  });
  
  if(rows.length===0){ alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø±Ø³Ø§Ù„."); return; }
  
  let header = "ÙØ±Ø²Ø§ØªØ´ÙŠ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠØ© - ÙØ§ØªÙˆØ±Ø© Ø¹Ù…Ù„\n\n";
  let tableHeader = "|Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©|Ø§Ù„ØªØ§Ø±ÙŠØ®|Ø§Ù„Ù†ÙˆØ¹|Ø§Ù„Ø¹Ø¯Ø¯|Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª|\n";
  let separator = "--------------------------------------\n";
  let messageText = header + tableHeader + separator + rows.join("\n") + "\n\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø¯: " + totalCount + "\n\nÙ…Ù„Ù PDF ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†Ø²ÙŠÙ„Ù‡ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡ Ù…Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.";
  
  let phone = "774353110";
  let message = encodeURIComponent(messageText);
  window.open(`https://wa.me/${phone}?text=${message}`, '_blank');
  alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ PDF ÙˆÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø±Ø³Ø§Ù„Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¥Ø±Ø³Ø§Ù„.");
}
</script>
</body>
</html>
